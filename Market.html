<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Market Prices • Peltra</title>
  <link rel="stylesheet" href="style/market.css" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <!-- HEADER -->
  <header class="sticky-header">
    <div class="market-logo-container">
      <img src="assets/Logo.png" alt="Peltra Logo" class="market-logo" />
      <h1 class="market-heading">Market Prices</h1>
      <p class="market-subheading">Live pellet & briquette intelligence • hyper‑local</p>
    </div>
  </header>

  <!-- NAV -->
  <nav class="sticky-nav">
    <a href="index.html">Home</a>
    <a class="active" href="market.html">Market Prices</a>
    <a href="news.html">News</a>
    <a href="contact.html">Contact</a>
  </nav>

  <main>
    <!-- CONTROLS: Location + Material -->
    <section class="panel controls">
      <div class="control-group">
        <label for="stateSelect">Location</label>
        <select id="stateSelect"></select>
      </div>

      <div class="control-group">
        <label>Material</label>
        <div class="segmented" role="tablist" aria-label="Material">
          <button class="seg active" data-material="Pellet" role="tab" aria-selected="true">Pellet</button>
          <button class="seg" data-material="Briquette" role="tab" aria-selected="false">Briquette</button>
        </div>
      </div>

      <div class="last-updated">
        <span id="lastUpdated">Last updated: --</span>
      </div>
    </section>

    <!-- SUMMARY CARDS -->
    <section class="panel summary">
      <div class="summary-card">
        <h3>Ex‑Yard Price</h3>
        <div class="big-price">₹<span id="exPrice">--</span>/ton</div>
        <div class="meta-row">
          <span id="lastDeal" class="pill">Last deal: --</span>
          <span class="confidence">
            Confidence:
            <span id="confVal">--%</span>
            <span class="bar"><span id="confBar"></span></span>
          </span>
        </div>
      </div>

      <div class="summary-card">
        <h3>Landed Estimate</h3>
        <div class="big-price">₹<span id="landedPrice">--</span>/ton</div>
        <p class="help">Based on your freight inputs below</p>
      </div>
    </section>

    <!-- BEST BUY / SELL -->
    <section class="panel best-row">
      <div class="best-card" id="bestBuyCard">
        <h4>Today’s Best Buy</h4>
        <p class="best-line"><span id="bestBuyState">--</span> • ₹<span id="bestBuyPrice">--</span>/ton</p>
        <button class="btn btn-primary" id="ctaBestBuy">Get this deal</button>
      </div>
      <div class="best-card" id="bestSellCard">
        <h4>Today’s Best Sell</h4>
        <p class="best-line"><span id="bestSellState">--</span> • ₹<span id="bestSellPrice">--</span>/ton</p>
        <button class="btn btn-outline" id="ctaBestSell">List my stock</button>
      </div>
    </section>

    <!-- FREIGHT CALCULATOR -->
    <section class="panel freight">
      <h3>Freight Calculator</h3>
      <form id="freightForm">
        <div class="grid">
          <div>
            <label for="distanceKm">Distance (km)</label>
            <input type="number" id="distanceKm" min="0" placeholder="e.g., 220" />
          </div>
          <div>
            <label for="tonnage">Tonnage (total)</label>
            <input type="number" id="tonnage" min="1" placeholder="e.g., 20" />
          </div>
          <div>
            <label for="ratePerKm">Truck rate (₹/km)</label>
            <input type="number" id="ratePerKm" min="0" placeholder="e.g., 28" />
          </div>
          <div class="grid-span">
            <button type="submit" class="btn btn-primary">Calculate Landed</button>
          </div>
        </div>
      </form>
      <p class="calc-note">Tip: Adjust truck rate for seasonality/region.</p>
    </section>

    <!-- TRENDS -->
    <section class="panel trends">
      <h3>Price Trends</h3>
      <div class="trend-grid">
        <div class="chart-box">
          <h4 id="pelletChartTitle">Pellet Trend</h4>
          <canvas id="pelletChart" height="260"></canvas>
        </div>
        <div class="chart-box">
          <h4 id="briquetteChartTitle">Briquette Trend</h4>
          <canvas id="briquetteChart" height="260"></canvas>
        </div>
      </div>
    </section>

    <!-- POLICY / NEWS FEED -->
    <section class="panel policy">
      <h3>Policy & Market Updates</h3>
      <div id="policyFeed" class="news-feed"></div>
      <a class="link-more" href="news.html">See all news →</a>
    </section>

    <!-- CTAS -->
    <section class="panel ctas">
      <button class="btn btn-primary" id="rateLockBtn">Lock my rate</button>
      <button class="btn btn-outline" id="listStockBtn">List my stock</button>
    </section>
  </main>

  <!-- SIMPLE MODALS -->
  <div class="modal" id="rateLockModal" hidden>
    <div class="modal-card">
      <h3>Rate Lock Request</h3>
      <form id="rateLockForm">
        <label>Company <input required type="text" id="rlCompany" /></label>
        <label>Quantity (tons) <input required type="number" id="rlQty" min="1" /></label>
        <label>Location <input required type="text" id="rlLoc" /></label>
        <div class="modal-actions">
          <button type="submit" class="btn btn-primary">Request callback</button>
          <button type="button" class="btn" data-close>Cancel</button>
        </div>
      </form>
    </div>
  </div>

  <div class="modal" id="listStockModal" hidden>
    <div class="modal-card">
      <h3>List Your Stock</h3>
      <form id="listStockForm">
        <label>Factory <input required type="text" id="lsFactory" /></label>
        <label>Material
          <select id="lsMaterial">
            <option value="Pellet">Pellet</option>
            <option value="Briquette">Briquette</option>
          </select>
        </label>
        <label>Quantity (tons) <input required type="number" id="lsQty" min="1" /></label>
        <label>Location <input required type="text" id="lsLoc" /></label>
        <div class="modal-actions">
          <button type="submit" class="btn btn-primary">Submit</button>
          <button type="button" class="btn" data-close>Cancel</button>
        </div>
      </form>
    </div>
  </div>

  <!-- SCRIPTS -->
  <script src="js/market.js"></script>
</body>
</html>